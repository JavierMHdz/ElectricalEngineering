
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>EE301 Lab5</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-02-24"><meta name="DC.source" content="EE301_Lab5.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>EE301 Lab5</h1><p>Javier Macossay-Hernandez, USC ID 9907093913, Lab Section 30813</p><pre class="codeinput">clc;
clear <span class="string">all</span>;
close <span class="string">all</span>;


<span class="comment">%Q1 (a)</span>
t = linspace(-0.5, 2, 1000);
plot(t,cos(linspace(-7.5,27,1000)),<span class="string">'k:'</span>);

grid <span class="string">on</span>;

<span class="comment">% The amplitude is equal to 1</span>
<span class="comment">% s(t)=A*cos(2*pi*f*t+phi) when t is equal to 0</span>
<span class="comment">% s(t)=Acos(phi)</span>
<span class="comment">% s(0)=0.7209=A*cos(phi)</span>
<span class="comment">% phi=cos^-1(0.7209)=0.7657</span>
<span class="comment">% rad = 43.8 degrees</span>

phi=acosd(0.7209)

<span class="comment">% t1=0.043</span>
<span class="comment">% t2=0.4985</span>
<span class="comment">% Period = T = 0.4985-0.043 = 0.4555 s</span>
<span class="comment">% f = 1/T = 1/0.4555 = 2.1954 Hz</span>

<span class="comment">% A*exp(j*phi), where the value of A=1</span>
<span class="comment">% phi=0.7657 rad</span>
<span class="comment">% s= 1*exp(j*0.7657), which is polar form</span>
<span class="comment">% s= cos(0.7657)+j*sin(0.7657) = 0.721+j*0.693</span>

Rectangual= 1*exp(j*0.7657)

<span class="comment">%Q1 (b)</span>
A = 1;
phi = 0.7657;
frq = 2.1954;
new = A*cos(2*pi*frq.*t-phi);

hold <span class="string">on</span>
plot(t, new)
title(<span class="string">'Graph1'</span>);
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'Amplitude'</span>);
legend(<span class="string">'Plot a'</span>,<span class="string">'Plot b'</span>);

<span class="comment">%Q2 (a)</span>
t_test = 0:99;
s_test = 1.3*cos(t_test*pi/10 + 2.8);

<span class="comment">% Amplitude is equal to 1.3</span>
<span class="comment">% A*cos(w*t+phi) = -1.225 when t equals to 0</span>
<span class="comment">% A*cos(phi) = -1.225</span>
<span class="comment">% phi = cos^-1(-1.225/1.3) = 2.8 rad = 160.44 degrees</span>

phi=acosd(-1.225/1.3)

<span class="comment">% 2*pi*f*t = t_test*pi*1/10</span>
<span class="comment">% -&gt; 1/10 = 2*f -&gt; f = 1/20</span>

<span class="comment">%Q2 (b)</span>
t_test = 0:99;
s_test = 1.3*cos(t_test*pi/10 + 2.8);
figure
plot(t_test,s_test)
title(<span class="string">'Graph2'</span>);
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'Amplitude'</span>);
grid <span class="string">on</span>

[A,phi]=apc(s_test, t_test, 1/20);

<span class="comment">%Q2 (c)</span>

<span class="comment">% w = 200*pi = 2*pi*f where f is equal to 100</span>

load(<span class="string">'lab5_data.mat'</span>)
figure
plot(t_samp,s_samp)
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'Amplitude'</span>);
title(<span class="string">'samp signal'</span>);
[A,phi] = apc(s_samp, t_samp, 100);
hold <span class="string">on</span>
new = A*cos(2*pi.*t_samp*100+phi);
plot(t_samp,new,<span class="string">'r'</span>)

<span class="comment">%Q2 (d)</span>

apc_support = 0:80;
apc_test = cos(apc_support*pi/15+0);

<span class="comment">% The amplitude is equal to 1</span>
<span class="comment">% The phase is equal to 0</span>
<span class="comment">% The frequency is equal to 1/30</span>

[A,phi]=apc(apc_test, apc_support, 1/30);
figure
plot(apc_support, apc_test)
hold <span class="string">on</span>
new=A*cos(2*pi.*apc_support*1/30+phi);
plot(apc_support,new,<span class="string">'r'</span>)
title(<span class="string">'Graph4'</span>);
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'Amplitude'</span>);
legend(<span class="string">'Plot a(apc_test)'</span>,<span class="string">'Plot b(new)'</span>);

<span class="comment">% The fundamental period, in this case,</span>
<span class="comment">% is 30 seconds.</span>
<span class="comment">% There are 2.75 periods included in apc_test</span>

abs(new - apc_test)
sum(abs(new - apc_test))

<span class="comment">%Q2 (e)</span>

A = ones(1,500);
phi = (zeros(1,500));

<span class="keyword">for</span> i = 10:500

apc_support = 0:i;
apc_test = cos(apc_support*pi/15+0);
[A(i),phi(i)] = apc(apc_test, apc_support, 1/30);
<span class="keyword">end</span>

i = 1:500;
figure
amplitude_error=abs(A-1);
subplot(2,1,1)
plot(i,amplitude_error)
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'amplitude error'</span>);
title(<span class="string">'amplitude error'</span>);
subplot(2,1,2)
plot(i,phi)
xlabel(<span class="string">'Time'</span>);
ylabel(<span class="string">'phase error'</span>);
title(<span class="string">'phase error'</span>);

<span class="comment">% For this particular case the amplitude estimates to the value of zero</span>
<span class="comment">% always.</span>
<span class="comment">% This will result in the amplitude never becoming one.</span>

<span class="comment">%Q3 (a)</span>

[frq,A,phi,X]=fape(s_test,t_test)
new = real(A*exp(j*(2*pi*frq.*t_test+phi)));

figure
plot(t_test,s_test)
grid
hold <span class="string">on</span>
plot(t_test, new,<span class="string">'r'</span>);

<span class="comment">% f = 1/20 = 0.05 Hz</span>
<span class="comment">% Amplitude is equal to 1.3</span>
<span class="comment">% s(t) = A*cos(2*pi*f*t+phi) where t is equal to 0</span>
<span class="comment">% s(t) = A*cos(phi)</span>
<span class="comment">% s(0) = -1.225 = A*cos(phi)</span>
<span class="comment">% phi = cos^-1(-1.225) = undefined. The angle is approximately pi/2 because</span>
<span class="comment">% that is the value where cosine is undefined.</span>
<span class="comment">% Yes, the estimates are correct.</span>

<span class="comment">%Q3 (b)</span>


[frq,A,phi,X]=fape(fape_test_s,fape_test_t)
new = real(A*exp(j*(2*pi*frq.*fape_test_t+phi)));

figure
plot(fape_test_t,fape_test_s)
grid
hold <span class="string">on</span>
plot(fape_test_t, new,<span class="string">'r'</span>);


<span class="comment">% The accuracy of estimates is not accurate. The phase is different in the</span>
<span class="comment">% actual signal.</span>
</pre><pre class="codeoutput">
phi =

   43.8712


Rectangual =

   0.7209 + 0.6930i


phi =

  160.4428


correlation =

  -47.1289


cos0 =

   -0.9521


correlation =

   -0.0500


cos0 =

   -1.0050


correlation =

   41.6436


cos0 =

    1.0411


ans =

  Columns 1 through 7

    0.0405    0.0982    0.1517    0.1984    0.2366    0.2643    0.2806

  Columns 8 through 14

    0.2845    0.2760    0.2555    0.2238    0.1823    0.1329    0.0776

  Columns 15 through 21

    0.0189    0.0405    0.0982    0.1517    0.1984    0.2366    0.2643

  Columns 22 through 28

    0.2806    0.2845    0.2760    0.2555    0.2238    0.1823    0.1329

  Columns 29 through 35

    0.0776    0.0189    0.0405    0.0982    0.1517    0.1984    0.2366

  Columns 36 through 42

    0.2643    0.2806    0.2845    0.2760    0.2555    0.2238    0.1823

  Columns 43 through 49

    0.1329    0.0776    0.0189    0.0405    0.0982    0.1517    0.1984

  Columns 50 through 56

    0.2366    0.2643    0.2806    0.2845    0.2760    0.2555    0.2238

  Columns 57 through 63

    0.1823    0.1329    0.0776    0.0189    0.0405    0.0982    0.1517

  Columns 64 through 70

    0.1984    0.2366    0.2643    0.2806    0.2845    0.2760    0.2555

  Columns 71 through 77

    0.2238    0.1823    0.1329    0.0776    0.0189    0.0405    0.0982

  Columns 78 through 81

    0.1517    0.1984    0.2366    0.2643


ans =

   14.5994


correlation =

    4.6064


cos0 =

    0.9213


correlation =

    5.0542


cos0 =

    0.9189


correlation =

    5.7087


cos0 =

    0.9514


correlation =

    6.5432


cos0 =

    1.0067


correlation =

    7.5000


cos0 =

    1.0714


correlation =

    8.5000


cos0 =

    1.1333


correlation =

    9.4568


cos0 =

    1.1821


correlation =

   10.2913


cos0 =

    1.2107


correlation =

   10.9458


cos0 =

    1.2162


correlation =

   11.3936


cos0 =

    1.1993


correlation =

   11.6436


cos0 =

    1.1644


correlation =

   11.7391


cos0 =

    1.1180


correlation =

   11.7500


cos0 =

    1.0682


correlation =

   11.7609


cos0 =

    1.0227


correlation =

   11.8564


cos0 =

    0.9880


correlation =

   12.1064


cos0 =

    0.9685


correlation =

   12.5542


cos0 =

    0.9657


correlation =

   13.2087


cos0 =

    0.9784


correlation =

   14.0432


cos0 =

    1.0031


correlation =

   15.0000


cos0 =

    1.0345


correlation =

    16


cos0 =

    1.0667


correlation =

   16.9568


cos0 =

    1.0940


correlation =

   17.7913


cos0 =

    1.1120


correlation =

   18.4458


cos0 =

    1.1179


correlation =

   18.8936


cos0 =

    1.1114


correlation =

   19.1436


cos0 =

    1.0939


correlation =

   19.2391


cos0 =

    1.0688


correlation =

   19.2500


cos0 =

    1.0405


correlation =

   19.2609


cos0 =

    1.0137


correlation =

   19.3564


cos0 =

    0.9926


correlation =

   19.6064


cos0 =

    0.9803


correlation =

   20.0542


cos0 =

    0.9783


correlation =

   20.7087


cos0 =

    0.9861


correlation =

   21.5432


cos0 =

    1.0020


correlation =

   22.5000


cos0 =

    1.0227


correlation =

   23.5000


cos0 =

    1.0444


correlation =

   24.4568


cos0 =

    1.0633


correlation =

   25.2913


cos0 =

    1.0762


correlation =

   25.9458


cos0 =

    1.0811


correlation =

   26.3936


cos0 =

    1.0773


correlation =

   26.6436


cos0 =

    1.0657


correlation =

   26.7391


cos0 =

    1.0486


correlation =

   26.7500


cos0 =

    1.0288


correlation =

   26.7609


cos0 =

    1.0098


correlation =

   26.8564


cos0 =

    0.9947


correlation =

   27.1064


cos0 =

    0.9857


correlation =

   27.5542


cos0 =

    0.9841


correlation =

   28.2087


cos0 =

    0.9898


correlation =

   29.0432


cos0 =

    1.0015


correlation =

   30.0000


cos0 =

    1.0169


correlation =

   31.0000


cos0 =

    1.0333


correlation =

   31.9568


cos0 =

    1.0478


correlation =

   32.7913


cos0 =

    1.0578


correlation =

   33.4458


cos0 =

    1.0618


correlation =

   33.8936


cos0 =

    1.0592


correlation =

   34.1436


cos0 =

    1.0506


correlation =

   34.2391


cos0 =

    1.0375


correlation =

   34.2500


cos0 =

    1.0224


correlation =

   34.2609


cos0 =

    1.0077


correlation =

   34.3564


cos0 =

    0.9958


correlation =

   34.6064


cos0 =

    0.9888


correlation =

   35.0542


cos0 =

    0.9874


correlation =

   35.7087


cos0 =

    0.9919


correlation =

   36.5432


cos0 =

    1.0012


correlation =

   37.5000


cos0 =

    1.0135


correlation =

   38.5000


cos0 =

    1.0267


correlation =

   39.4568


cos0 =

    1.0383


correlation =

   40.2913


cos0 =

    1.0465


correlation =

   40.9458


cos0 =

    1.0499


correlation =

   41.3936


cos0 =

    1.0479


correlation =

   41.6436


cos0 =

    1.0411


correlation =

   41.7391


cos0 =

    1.0306


correlation =

   41.7500


cos0 =

    1.0183


correlation =

   41.7609


cos0 =

    1.0063


correlation =

   41.8564


cos0 =

    0.9966


correlation =

   42.1064


cos0 =

    0.9907


correlation =

   42.5542


cos0 =

    0.9896


correlation =

   43.2087


cos0 =

    0.9933


correlation =

   44.0432


cos0 =

    1.0010


correlation =

   45.0000


cos0 =

    1.0112


correlation =

   46.0000


cos0 =

    1.0222


correlation =

   46.9568


cos0 =

    1.0320


correlation =

   47.7913


cos0 =

    1.0389


correlation =

   48.4458


cos0 =

    1.0418


correlation =

   48.8936


cos0 =

    1.0403


correlation =

   49.1436


cos0 =

    1.0346


correlation =

   49.2391


cos0 =

    1.0258


correlation =

   49.2500


cos0 =

    1.0155


correlation =

   49.2609


cos0 =

    1.0053


correlation =

   49.3564


cos0 =

    0.9971


correlation =

   49.6064


cos0 =

    0.9921


correlation =

   50.0542


cos0 =

    0.9912


correlation =

   50.7087


cos0 =

    0.9943


correlation =

   51.5432


cos0 =

    1.0008


correlation =

   52.5000


cos0 =

    1.0096


correlation =

   53.5000


cos0 =

    1.0190


correlation =

   54.4568


cos0 =

    1.0275


correlation =

   55.2913


cos0 =

    1.0335


correlation =

   55.9458


cos0 =

    1.0360


correlation =

   56.3936


cos0 =

    1.0347


correlation =

   56.6436


cos0 =

    1.0299


correlation =

   56.7391


cos0 =

    1.0223


correlation =

   56.7500


cos0 =

    1.0134


correlation =

   56.7609


cos0 =

    1.0046


correlation =

   56.8564


cos0 =

    0.9975


correlation =

   57.1064


cos0 =

    0.9932


correlation =

   57.5542


cos0 =

    0.9923


correlation =

   58.2087


cos0 =

    0.9950


correlation =

   59.0432


cos0 =

    1.0007


correlation =

   60.0000


cos0 =

    1.0084


correlation =

   61.0000


cos0 =

    1.0167


correlation =

   61.9568


cos0 =

    1.0241


correlation =

   62.7913


cos0 =

    1.0294


correlation =

   63.4458


cos0 =

    1.0316


correlation =

   63.8936


cos0 =

    1.0305


correlation =

   64.1436


cos0 =

    1.0263


correlation =

   64.2391


cos0 =

    1.0197


correlation =

   64.2500


cos0 =

    1.0118


correlation =

   64.2609


cos0 =

    1.0041


correlation =

   64.3564


cos0 =

    0.9978


correlation =

   64.6064


cos0 =

    0.9939


correlation =

   65.0542


cos0 =

    0.9932


correlation =

   65.7087


cos0 =

    0.9956


correlation =

   66.5432


cos0 =

    1.0007


correlation =

   67.5000


cos0 =

    1.0075


correlation =

   68.5000


cos0 =

    1.0148


correlation =

   69.4568


cos0 =

    1.0214


correlation =

   70.2913


cos0 =

    1.0262


correlation =

   70.9458


cos0 =

    1.0282


correlation =

   71.3936


cos0 =

    1.0272


correlation =

   71.6436


cos0 =

    1.0235


correlation =

   71.7391


cos0 =

    1.0176


correlation =

   71.7500


cos0 =

    1.0106


correlation =

   71.7609


cos0 =

    1.0036


correlation =

   71.8564


cos0 =

    0.9980


correlation =

   72.1064


cos0 =

    0.9946


correlation =

   72.5542


cos0 =

    0.9939


correlation =

   73.2087


cos0 =

    0.9960


correlation =

   74.0432


cos0 =

    1.0006


correlation =

    75


cos0 =

    1.0067


correlation =

    76


cos0 =

    1.0133


correlation =

   76.9568


cos0 =

    1.0193


correlation =

   77.7913


cos0 =

    1.0236


correlation =

   78.4458


cos0 =

    1.0254


correlation =

   78.8936


cos0 =

    1.0246


correlation =

   79.1436


cos0 =

    1.0212


correlation =

   79.2391


cos0 =

    1.0159


correlation =

   79.2500


cos0 =

    1.0096


correlation =

   79.2609


cos0 =

    1.0033


correlation =

   79.3564


cos0 =

    0.9982


correlation =

   79.6064


cos0 =

    0.9951


correlation =

   80.0542


cos0 =

    0.9945


correlation =

   80.7087


cos0 =

    0.9964


correlation =

   81.5432


cos0 =

    1.0005


correlation =

   82.5000


cos0 =

    1.0061


correlation =

   83.5000


cos0 =

    1.0121


correlation =

   84.4568


cos0 =

    1.0176


correlation =

   85.2913


cos0 =

    1.0215


correlation =

   85.9458


cos0 =

    1.0232


correlation =

   86.3936


cos0 =

    1.0224


correlation =

   86.6436


cos0 =

    1.0193


correlation =

   86.7391


cos0 =

    1.0145


correlation =

   86.7500


cos0 =

    1.0087


correlation =

   86.7609


cos0 =

    1.0030


correlation =

   86.8564


cos0 =

    0.9983


correlation =

   87.1064


cos0 =

    0.9955


correlation =

   87.5542


cos0 =

    0.9949


correlation =

   88.2087


cos0 =

    0.9967


correlation =

   89.0432


cos0 =

    1.0005


correlation =

   90.0000


cos0 =

    1.0056


correlation =

   91.0000


cos0 =

    1.0111


correlation =

   91.9568


cos0 =

    1.0161


correlation =

   92.7913


cos0 =

    1.0197


correlation =

   93.4458


cos0 =

    1.0213


correlation =

   93.8936


cos0 =

    1.0206


correlation =

   94.1436


cos0 =

    1.0178


correlation =

   94.2391


cos0 =

    1.0133


correlation =

   94.2500


cos0 =

    1.0080


correlation =

   94.2609


cos0 =

    1.0028


correlation =

   94.3564


cos0 =

    0.9985


correlation =

   94.6064


cos0 =

    0.9959


correlation =

   95.0542


cos0 =

    0.9953


correlation =

   95.7087


cos0 =

    0.9970


correlation =

   96.5432


cos0 =

    1.0004


correlation =

   97.5000


cos0 =

    1.0052


correlation =

   98.5000


cos0 =

    1.0103


correlation =

   99.4568


cos0 =

    1.0149


correlation =

  100.2913


cos0 =

    1.0182


correlation =

  100.9458


cos0 =

    1.0197


correlation =

  101.3936


cos0 =

    1.0190


correlation =

  101.6436


cos0 =

    1.0164


correlation =

  101.7391


cos0 =

    1.0123


correlation =

  101.7500


cos0 =

    1.0074


correlation =

  101.7609


cos0 =

    1.0026


correlation =

  101.8564


cos0 =

    0.9986


correlation =

  102.1064


cos0 =

    0.9962


correlation =

  102.5542


cos0 =

    0.9957


correlation =

  103.2087


cos0 =

    0.9972


correlation =

  104.0432


cos0 =

    1.0004


correlation =

  105.0000


cos0 =

    1.0048


correlation =

  106.0000


cos0 =

    1.0095


correlation =

  106.9568


cos0 =

    1.0138


correlation =

  107.7913


cos0 =

    1.0169


correlation =

  108.4458


cos0 =

    1.0183


correlation =

  108.8936


cos0 =

    1.0177


correlation =

  109.1436


cos0 =

    1.0153


correlation =

  109.2391


cos0 =

    1.0115


correlation =

  109.2500


cos0 =

    1.0069


correlation =

  109.2609


cos0 =

    1.0024


correlation =

  109.3564


cos0 =

    0.9987


correlation =

  109.6064


cos0 =

    0.9964


correlation =

  110.0542


cos0 =

    0.9960


correlation =

  110.7087


cos0 =

    0.9974


correlation =

  111.5432


cos0 =

    1.0004


correlation =

  112.5000


cos0 =

    1.0045


correlation =

  113.5000


cos0 =

    1.0089


correlation =

  114.4568


cos0 =

    1.0129


correlation =

  115.2913


cos0 =

    1.0158


correlation =

  115.9458


cos0 =

    1.0171


correlation =

  116.3936


cos0 =

    1.0165


correlation =

  116.6436


cos0 =

    1.0143


correlation =

  116.7391


cos0 =

    1.0107


correlation =

  116.7500


cos0 =

    1.0065


correlation =

  116.7609


cos0 =

    1.0022


correlation =

  116.8564


cos0 =

    0.9988


correlation =

  117.1064


cos0 =

    0.9967


correlation =

  117.5542


cos0 =

    0.9962


correlation =

  118.2087


cos0 =

    0.9975


correlation =

  119.0432


cos0 =

    1.0004


correlation =

  120.0000


cos0 =

    1.0042


correlation =

  121.0000


cos0 =

    1.0083


correlation =

  121.9568


cos0 =

    1.0121


correlation =

  122.7913


cos0 =

    1.0148


correlation =

  123.4458


cos0 =

    1.0160


correlation =

  123.8936


cos0 =

    1.0155


correlation =

  124.1436


cos0 =

    1.0134


correlation =

  124.2391


cos0 =

    1.0101


correlation =

  124.2500


cos0 =

    1.0061


correlation =

  124.2609


cos0 =

    1.0021


correlation =

  124.3564


cos0 =

    0.9988


correlation =

  124.6064


cos0 =

    0.9969


correlation =

  125.0542


cos0 =

    0.9964


correlation =

  125.7087


cos0 =

    0.9977


correlation =

  126.5432


cos0 =

    1.0003


correlation =

  127.5000


cos0 =

    1.0039


correlation =

  128.5000


cos0 =

    1.0078


correlation =

  129.4568


cos0 =

    1.0114


correlation =

  130.2913


cos0 =

    1.0139


correlation =

  130.9458


cos0 =

    1.0151


correlation =

  131.3936


cos0 =

    1.0146


correlation =

  131.6436


cos0 =

    1.0126


correlation =

  131.7391


cos0 =

    1.0095


correlation =

  131.7500


cos0 =

    1.0057


correlation =

  131.7609


cos0 =

    1.0020


correlation =

  131.8564


cos0 =

    0.9989


correlation =

  132.1064


cos0 =

    0.9970


correlation =

  132.5542


cos0 =

    0.9966


correlation =

  133.2087


cos0 =

    0.9978


correlation =

  134.0432


cos0 =

    1.0003


correlation =

  135.0000


cos0 =

    1.0037


correlation =

  136.0000


cos0 =

    1.0074


correlation =

  136.9568


cos0 =

    1.0108


correlation =

  137.7913


cos0 =

    1.0132


correlation =

  138.4458


cos0 =

    1.0143


correlation =

  138.8936


cos0 =

    1.0138


correlation =

  139.1436


cos0 =

    1.0120


correlation =

  139.2391


cos0 =

    1.0090


correlation =

  139.2500


cos0 =

    1.0054


correlation =

  139.2609


cos0 =

    1.0019


correlation =

  139.3564


cos0 =

    0.9990


correlation =

  139.6064


cos0 =

    0.9972


correlation =

  140.0542


cos0 =

    0.9968


correlation =

  140.7087


cos0 =

    0.9979


correlation =

  141.5432


cos0 =

    1.0003


correlation =

  142.5000


cos0 =

    1.0035


correlation =

  143.5000


cos0 =

    1.0070


correlation =

  144.4568


cos0 =

    1.0102


correlation =

  145.2913


cos0 =

    1.0125


correlation =

  145.9458


cos0 =

    1.0135


correlation =

  146.3936


cos0 =

    1.0131


correlation =

  146.6436


cos0 =

    1.0113


correlation =

  146.7391


cos0 =

    1.0085


correlation =

  146.7500


cos0 =

    1.0051


correlation =

  146.7609


cos0 =

    1.0018


correlation =

  146.8564


cos0 =

    0.9990


correlation =

  147.1064


cos0 =

    0.9973


correlation =

  147.5542


cos0 =

    0.9970


correlation =

  148.2087


cos0 =

    0.9980


correlation =

  149.0432


cos0 =

    1.0003


correlation =

  150.0000


cos0 =

    1.0033


correlation =

  151.0000


cos0 =

    1.0067


correlation =

  151.9568


cos0 =

    1.0097


correlation =

  152.7913


cos0 =

    1.0119


correlation =

  153.4458


cos0 =

    1.0128


correlation =

  153.8936


cos0 =

    1.0125


correlation =

  154.1436


cos0 =

    1.0108


correlation =

  154.2391


cos0 =

    1.0081


correlation =

  154.2500


cos0 =

    1.0049


correlation =

  154.2609


cos0 =

    1.0017


correlation =

  154.3564


cos0 =

    0.9991


correlation =

  154.6064


cos0 =

    0.9975


correlation =

  155.0542


cos0 =

    0.9971


correlation =

  155.7087


cos0 =

    0.9981


correlation =

  156.5432


cos0 =

    1.0003


correlation =

  157.5000


cos0 =

    1.0032


correlation =

  158.5000


cos0 =

    1.0063


correlation =

  159.4568


cos0 =

    1.0092


correlation =

  160.2913


cos0 =

    1.0113


correlation =

  160.9458


cos0 =

    1.0122


correlation =

  161.3936


cos0 =

    1.0119


correlation =

  161.6436


cos0 =

    1.0103


correlation =

  161.7391


cos0 =

    1.0077


correlation =

  161.7500


cos0 =

    1.0047


correlation =

  161.7609


cos0 =

    1.0016


correlation =

  161.8564


cos0 =

    0.9991


correlation =

  162.1064


cos0 =

    0.9976


correlation =

  162.5542


cos0 =

    0.9973


correlation =

  163.2087


cos0 =

    0.9982


correlation =

  164.0432


cos0 =

    1.0003


correlation =

  165.0000


cos0 =

    1.0030


correlation =

  166.0000


cos0 =

    1.0061


correlation =

  166.9568


cos0 =

    1.0088


correlation =

  167.7913


cos0 =

    1.0108


correlation =

  168.4458


cos0 =

    1.0117


correlation =

  168.8936


cos0 =

    1.0113


correlation =

  169.1436


cos0 =

    1.0098


correlation =

  169.2391


cos0 =

    1.0074


correlation =

  169.2500


cos0 =

    1.0045


correlation =

  169.2609


cos0 =

    1.0015


correlation =

  169.3564


cos0 =

    0.9992


correlation =

  169.6064


cos0 =

    0.9977


correlation =

  170.0542


cos0 =

    0.9974


correlation =

  170.7087


cos0 =

    0.9983


correlation =

  171.5432


cos0 =

    1.0003


correlation =

  172.5000


cos0 =

    1.0029


correlation =

  173.5000


cos0 =

    1.0058


correlation =

  174.4568


cos0 =

    1.0084


correlation =

  175.2913


cos0 =

    1.0103


correlation =

  175.9458


cos0 =

    1.0112


correlation =

  176.3936


cos0 =

    1.0109


correlation =

  176.6436


cos0 =

    1.0094


correlation =

  176.7391


cos0 =

    1.0071


correlation =

  176.7500


cos0 =

    1.0043


correlation =

  176.7609


cos0 =

    1.0015


correlation =

  176.8564


cos0 =

    0.9992


correlation =

  177.1064


cos0 =

    0.9978


correlation =

  177.5542


cos0 =

    0.9975


correlation =

  178.2087


cos0 =

    0.9984


correlation =

  179.0432


cos0 =

    1.0002


correlation =

  180.0000


cos0 =

    1.0028


correlation =

  181.0000


cos0 =

    1.0056


correlation =

  181.9568


cos0 =

    1.0081


correlation =

  182.7913


cos0 =

    1.0099


correlation =

  183.4458


cos0 =

    1.0107


correlation =

  183.8936


cos0 =

    1.0104


correlation =

  184.1436


cos0 =

    1.0090


correlation =

  184.2391


cos0 =

    1.0068


correlation =

  184.2500


cos0 =

    1.0041


correlation =

  184.2609


cos0 =

    1.0014


correlation =

  184.3564


cos0 =

    0.9992


correlation =

  184.6064


cos0 =

    0.9979


correlation =

  185.0542


cos0 =

    0.9976


correlation =

  185.7087


cos0 =

    0.9984


correlation =

  186.5432


cos0 =

    1.0002


correlation =

  187.5000


cos0 =

    1.0027


correlation =

  188.5000


cos0 =

    1.0053


correlation =

  189.4568


cos0 =

    1.0077


correlation =

  190.2913


cos0 =

    1.0095


correlation =

  190.9458


cos0 =

    1.0103


correlation =

  191.3936


cos0 =

    1.0100


correlation =

  191.6436


cos0 =

    1.0087


correlation =

  191.7391


cos0 =

    1.0065


correlation =

  191.7500


cos0 =

    1.0039


correlation =

  191.7609


cos0 =

    1.0014


correlation =

  191.8564


cos0 =

    0.9993


correlation =

  192.1064


cos0 =

    0.9980


correlation =

  192.5542


cos0 =

    0.9977


correlation =

  193.2087


cos0 =

    0.9985


correlation =

  194.0432


cos0 =

    1.0002


correlation =

  195.0000


cos0 =

    1.0026


correlation =

  196.0000


cos0 =

    1.0051


correlation =

  196.9568


cos0 =

    1.0075


correlation =

  197.7913


cos0 =

    1.0091


correlation =

  198.4458


cos0 =

    1.0099


correlation =

  198.8936


cos0 =

    1.0096


correlation =

  199.1436


cos0 =

    1.0083


correlation =

  199.2391


cos0 =

    1.0063


correlation =

  199.2500


cos0 =

    1.0038


correlation =

  199.2609


cos0 =

    1.0013


correlation =

  199.3564


cos0 =

    0.9993


correlation =

  199.6064


cos0 =

    0.9980


correlation =

  200.0542


cos0 =

    0.9978


correlation =

  200.7087


cos0 =

    0.9986


correlation =

  201.5432


cos0 =

    1.0002


correlation =

  202.5000


cos0 =

    1.0025


correlation =

  203.5000


cos0 =

    1.0049


correlation =

  204.4568


cos0 =

    1.0072


correlation =

  205.2913


cos0 =

    1.0088


correlation =

  205.9458


cos0 =

    1.0095


correlation =

  206.3936


cos0 =

    1.0093


correlation =

  206.6436


cos0 =

    1.0080


correlation =

  206.7391


cos0 =

    1.0060


correlation =

  206.7500


cos0 =

    1.0036


correlation =

  206.7609


cos0 =

    1.0013


correlation =

  206.8564


cos0 =

    0.9993


correlation =

  207.1064


cos0 =

    0.9981


correlation =

  207.5542


cos0 =

    0.9979


correlation =

  208.2087


cos0 =

    0.9986


correlation =

  209.0432


cos0 =

    1.0002


correlation =

  210.0000


cos0 =

    1.0024


correlation =

  211.0000


cos0 =

    1.0048


correlation =

  211.9568


cos0 =

    1.0069


correlation =

  212.7913


cos0 =

    1.0085


correlation =

  213.4458


cos0 =

    1.0092


correlation =

  213.8936


cos0 =

    1.0089


correlation =

  214.1436


cos0 =

    1.0077


correlation =

  214.2391


cos0 =

    1.0058


correlation =

  214.2500


cos0 =

    1.0035


correlation =

  214.2609


cos0 =

    1.0012


correlation =

  214.3564


cos0 =

    0.9993


correlation =

  214.6064


cos0 =

    0.9982


correlation =

  215.0542


cos0 =

    0.9979


correlation =

  215.7087


cos0 =

    0.9987


correlation =

  216.5432


cos0 =

    1.0002


correlation =

  217.5000


cos0 =

    1.0023


correlation =

  218.5000


cos0 =

    1.0046


correlation =

  219.4568


cos0 =

    1.0067


correlation =

  220.2913


cos0 =

    1.0082


correlation =

  220.9458


cos0 =

    1.0089


correlation =

  221.3936


cos0 =

    1.0086


correlation =

  221.6436


cos0 =

    1.0075


correlation =

  221.7391


cos0 =

    1.0056


correlation =

  221.7500


cos0 =

    1.0034


correlation =

  221.7609


cos0 =

    1.0012


correlation =

  221.8564


cos0 =

    0.9994


correlation =

  222.1064


cos0 =

    0.9982


correlation =

  222.5542


cos0 =

    0.9980


correlation =

  223.2087


cos0 =

    0.9987


correlation =

  224.0432


cos0 =

    1.0002


correlation =

  225.0000


cos0 =

    1.0022


correlation =

  226.0000


cos0 =

    1.0044


correlation =

  226.9568


cos0 =

    1.0065


correlation =

  227.7913


cos0 =

    1.0079


correlation =

  228.4458


cos0 =

    1.0086


correlation =

  228.8936


cos0 =

    1.0083


correlation =

  229.1436


cos0 =

    1.0072


correlation =

  229.2391


cos0 =

    1.0054


correlation =

  229.2500


cos0 =

    1.0033


correlation =

  229.2609


cos0 =

    1.0011


correlation =

  229.3564


cos0 =

    0.9994


correlation =

  229.6064


cos0 =

    0.9983


correlation =

  230.0542


cos0 =

    0.9981


correlation =

  230.7087


cos0 =

    0.9987


correlation =

  231.5432


cos0 =

    1.0002


correlation =

  232.5000


cos0 =

    1.0022


correlation =

  233.5000


cos0 =

    1.0043


correlation =

  234.4568


cos0 =

    1.0063


correlation =

  235.2913


cos0 =

    1.0077


correlation =

  235.9458


cos0 =

    1.0083


correlation =

  236.3936


cos0 =

    1.0081


correlation =

  236.6436


cos0 =

    1.0070


correlation =

  236.7391


cos0 =

    1.0053


correlation =

  236.7500


cos0 =

    1.0032


correlation =

  236.7609


cos0 =

    1.0011


correlation =

  236.8564


cos0 =

    0.9994


correlation =

  237.1064


cos0 =

    0.9983


correlation =

  237.5542


cos0 =

    0.9981


correlation =

  238.2087


cos0 =

    0.9988


correlation =

  239.0432


cos0 =

    1.0002


correlation =

  240.0000


cos0 =

    1.0021


correlation =

  241.0000


cos0 =

    1.0042


correlation =

  241.9568


cos0 =

    1.0061


correlation =

  242.7913


cos0 =

    1.0074


correlation =

  243.4458


cos0 =

    1.0081


correlation =

  243.8936


cos0 =

    1.0078


correlation =

  244.1436


cos0 =

    1.0068


correlation =

  244.2391


cos0 =

    1.0051


correlation =

  244.2500


cos0 =

    1.0031


correlation =

  244.2609


cos0 =

    1.0011


correlation =

  244.3564


cos0 =

    0.9994


correlation =

  244.6064


cos0 =

    0.9984


correlation =

  245.0542


cos0 =

    0.9982


correlation =

  245.7087


cos0 =

    0.9988


correlation =

  246.5432


cos0 =

    1.0002


correlation =

  247.5000


cos0 =

    1.0020


correlation =

  248.5000


cos0 =

    1.0040


correlation =

  249.4568


cos0 =

    1.0059


correlation =

  250.2913


cos0 =

    1.0072


correlation =

  250.9458


cos0 =

    1.0078


correlation =

  251.3936


cos0 =

    1.0076


correlation =

  251.6436


cos0 =

    1.0066


frq =

    0.0505


correlation =

  -43.9669


cos0 =

   -0.8882


frq =

    0.0505


A =

    1.2995


phi =

    2.6643


X =

   0.0004 + 0.0010i
   0.0017 + 0.0023i
   0.0051 + 0.0046i
   0.0166 + 0.0112i
  -0.4441 - 0.2394i
  -0.0277 - 0.0124i
  -0.0177 - 0.0068i
  -0.0143 - 0.0048i
  -0.0127 - 0.0037i
  -0.0117 - 0.0031i
  -0.0111 - 0.0026i
  -0.0107 - 0.0023i
  -0.0103 - 0.0020i
  -0.0101 - 0.0018i
  -0.0099 - 0.0017i
  -0.0098 - 0.0015i
  -0.0097 - 0.0014i
  -0.0096 - 0.0013i
  -0.0095 - 0.0012i
  -0.0094 - 0.0011i
  -0.0094 - 0.0010i
  -0.0093 - 0.0010i
  -0.0093 - 0.0009i
  -0.0092 - 0.0008i
  -0.0092 - 0.0008i
  -0.0092 - 0.0007i
  -0.0092 - 0.0007i
  -0.0091 - 0.0006i
  -0.0091 - 0.0006i
  -0.0091 - 0.0006i
  -0.0091 - 0.0005i
  -0.0091 - 0.0005i
  -0.0091 - 0.0005i
  -0.0091 - 0.0004i
  -0.0090 - 0.0004i
  -0.0090 - 0.0004i
  -0.0090 - 0.0003i
  -0.0090 - 0.0003i
  -0.0090 - 0.0003i
  -0.0090 - 0.0002i
  -0.0090 - 0.0002i
  -0.0090 - 0.0002i
  -0.0090 - 0.0002i
  -0.0090 - 0.0001i
  -0.0090 - 0.0001i
  -0.0090 - 0.0001i
  -0.0090 - 0.0001i
  -0.0090 - 0.0000i
  -0.0090 - 0.0000i
  -0.0090 + 0.0000i


frq =

    1.0309


correlation =

   -1.4860


cos0 =

   -0.7660


frq =

    1.0309


A =

    4.2770


phi =

    2.4434


X =

   0.0544 - 0.0089i
   0.0727 - 0.0233i
   0.1531 - 0.0702i
  -0.3830 + 0.2208i
  -0.0771 + 0.0517i
  -0.0418 + 0.0310i
  -0.0287 + 0.0227i
  -0.0220 + 0.0180i
  -0.0180 + 0.0151i
  -0.0154 + 0.0129i
  -0.0136 + 0.0114i
  -0.0123 + 0.0101i
  -0.0114 + 0.0091i
  -0.0106 + 0.0083i
  -0.0100 + 0.0076i
  -0.0096 + 0.0069i
  -0.0092 + 0.0064i
  -0.0089 + 0.0059i
  -0.0086 + 0.0055i
  -0.0084 + 0.0051i
  -0.0082 + 0.0048i
  -0.0080 + 0.0045i
  -0.0079 + 0.0042i
  -0.0077 + 0.0039i
  -0.0076 + 0.0036i
  -0.0075 + 0.0034i
  -0.0074 + 0.0032i
  -0.0074 + 0.0030i
  -0.0073 + 0.0028i
  -0.0073 + 0.0026i
  -0.0072 + 0.0024i
  -0.0072 + 0.0022i
  -0.0071 + 0.0021i
  -0.0071 + 0.0019i
  -0.0070 + 0.0018i
  -0.0070 + 0.0016i
  -0.0070 + 0.0015i
  -0.0070 + 0.0013i
  -0.0069 + 0.0012i
  -0.0069 + 0.0011i
  -0.0069 + 0.0009i
  -0.0069 + 0.0008i
  -0.0069 + 0.0007i
  -0.0069 + 0.0006i
  -0.0069 + 0.0004i
  -0.0069 + 0.0003i
  -0.0069 + 0.0002i
  -0.0069 + 0.0001i
  -0.0069 - 0.0001i

</pre><img vspace="5" hspace="5" src="EE301_Lab5_01.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_02.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_03.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_04.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_05.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_06.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_07.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_08.png" alt=""> <img vspace="5" hspace="5" src="EE301_Lab5_09.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% EE301 Lab5
% Javier Macossay-Hernandez,
% USC ID 9907093913,
% Lab Section 30813

clc;
clear all;
close all;


%Q1 (a)
t = linspace(-0.5, 2, 1000);
plot(t,cos(linspace(-7.5,27,1000)),'k:');

grid on;

% The amplitude is equal to 1
% s(t)=A*cos(2*pi*f*t+phi) when t is equal to 0
% s(t)=Acos(phi)
% s(0)=0.7209=A*cos(phi) 
% phi=cos^-1(0.7209)=0.7657
% rad = 43.8 degrees

phi=acosd(0.7209)

% t1=0.043
% t2=0.4985
% Period = T = 0.4985-0.043 = 0.4555 s
% f = 1/T = 1/0.4555 = 2.1954 Hz

% A*exp(j*phi), where the value of A=1
% phi=0.7657 rad
% s= 1*exp(j*0.7657), which is polar form
% s= cos(0.7657)+j*sin(0.7657) = 0.721+j*0.693

Rectangual= 1*exp(j*0.7657)

%Q1 (b)
A = 1;
phi = 0.7657;
frq = 2.1954;
new = A*cos(2*pi*frq.*t-phi);

hold on
plot(t, new)
title('Graph1'); 
xlabel('Time');
ylabel('Amplitude');
legend('Plot a','Plot b');

%Q2 (a)
t_test = 0:99;
s_test = 1.3*cos(t_test*pi/10 + 2.8);

% Amplitude is equal to 1.3
% A*cos(w*t+phi) = -1.225 when t equals to 0
% A*cos(phi) = -1.225
% phi = cos^-1(-1.225/1.3) = 2.8 rad = 160.44 degrees

phi=acosd(-1.225/1.3)

% 2*pi*f*t = t_test*pi*1/10
% -> 1/10 = 2*f -> f = 1/20

%Q2 (b)
t_test = 0:99;
s_test = 1.3*cos(t_test*pi/10 + 2.8);
figure
plot(t_test,s_test)
title('Graph2'); 
xlabel('Time');
ylabel('Amplitude');
grid on

[A,phi]=apc(s_test, t_test, 1/20);

%Q2 (c)

% w = 200*pi = 2*pi*f where f is equal to 100

load('lab5_data.mat')
figure
plot(t_samp,s_samp)
xlabel('Time');
ylabel('Amplitude');
title('samp signal');
[A,phi] = apc(s_samp, t_samp, 100);
hold on
new = A*cos(2*pi.*t_samp*100+phi);
plot(t_samp,new,'r')

%Q2 (d)

apc_support = 0:80;
apc_test = cos(apc_support*pi/15+0);

% The amplitude is equal to 1
% The phase is equal to 0
% The frequency is equal to 1/30

[A,phi]=apc(apc_test, apc_support, 1/30);
figure
plot(apc_support, apc_test)
hold on
new=A*cos(2*pi.*apc_support*1/30+phi);
plot(apc_support,new,'r')
title('Graph4'); 
xlabel('Time');
ylabel('Amplitude');
legend('Plot a(apc_test)','Plot b(new)');

% The fundamental period, in this case,
% is 30 seconds.
% There are 2.75 periods included in apc_test

abs(new - apc_test)
sum(abs(new - apc_test))

%Q2 (e)

A = ones(1,500);
phi = (zeros(1,500));

for i = 10:500

apc_support = 0:i;
apc_test = cos(apc_support*pi/15+0);
[A(i),phi(i)] = apc(apc_test, apc_support, 1/30);
end

i = 1:500;
figure
amplitude_error=abs(A-1);
subplot(2,1,1)
plot(i,amplitude_error)
xlabel('Time');
ylabel('amplitude error');
title('amplitude error');
subplot(2,1,2)
plot(i,phi)
xlabel('Time');
ylabel('phase error');
title('phase error');

% For this particular case the amplitude estimates to the value of zero
% always.
% This will result in the amplitude never becoming one.

%Q3 (a)

[frq,A,phi,X]=fape(s_test,t_test)
new = real(A*exp(j*(2*pi*frq.*t_test+phi)));

figure
plot(t_test,s_test)
grid
hold on
plot(t_test, new,'r');

% f = 1/20 = 0.05 Hz
% Amplitude is equal to 1.3
% s(t) = A*cos(2*pi*f*t+phi) where t is equal to 0
% s(t) = A*cos(phi)
% s(0) = -1.225 = A*cos(phi)
% phi = cos^-1(-1.225) = undefined. The angle is approximately pi/2 because
% that is the value where cosine is undefined.
% Yes, the estimates are correct.

%Q3 (b)


[frq,A,phi,X]=fape(fape_test_s,fape_test_t)
new = real(A*exp(j*(2*pi*frq.*fape_test_t+phi)));

figure
plot(fape_test_t,fape_test_s)
grid
hold on
plot(fape_test_t, new,'r');


% The accuracy of estimates is not accurate. The phase is different in the
% actual signal.
##### SOURCE END #####
--></body></html>